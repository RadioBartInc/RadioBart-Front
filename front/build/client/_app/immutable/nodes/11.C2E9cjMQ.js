import{e as oe}from"../chunks/index.CzR0xuCU.js";import{s as te,n as L,r as ne,o as le,d as W}from"../chunks/scheduler.Cz3TSd7V.js";import{S as se,i as re,e as C,s as O,c as w,d as N,h as S,g as v,A as ae,o as m,j as P,k as h,B as K,z as Q,E as ie,u as ce,b as z,f as F,C as Y,l as G,m as R,n as U,p as j,t as B,a as D,r as V}from"../chunks/index.DKOtY3uX.js";import{e as Z,N as fe}from"../chunks/Navbar.CYHUjA86.js";import{R as ue}from"../chunks/Review.BwtD2Axs.js";import{U as me,a as he,n as de,b as _e,C as pe,o as ge}from"../chunks/APIAdapter.CWbTadu6.js";import{M as ve}from"../chunks/limits.C1Ngrwk2.js";function be({params:i}){if(i.id)return{id:i.id};oe(404,"Not found")}const Me=Object.freeze(Object.defineProperty({__proto__:null,load:be},Symbol.toStringTag,{value:"Module"}));function $(i,e,s){const a=i.slice();return a[14]=e[s],a}function x(i){let e,s;return{c(){e=C("p"),s=z(i[1]),this.h()},l(a){e=w(a,"P",{class:!0,style:!0});var o=N(e);s=F(o,i[1]),o.forEach(v),this.h()},h(){m(e,"class","submission-message"),Y(e,"color",i[0])},m(a,o){P(a,e,o),h(e,s)},p(a,o){o&2&&G(s,a[1]),o&1&&Y(e,"color",a[0])},d(a){a&&v(e)}}}function ee(i){var H;let e,s,a,o,f,d,_,p,E,y,n=((H=i[3][i[14].id])==null?void 0:H.name)+"",g,t,r,u,l=i[14].content+"",c,q;return{c(){e=C("div"),s=C("div"),a=C("div"),o=C("a"),f=C("img"),p=O(),E=C("p"),y=C("a"),g=z(n),r=O(),u=C("p"),c=z(l),q=O(),this.h()},l(b){e=w(b,"DIV",{class:!0});var I=N(e);s=w(I,"DIV",{class:!0});var T=N(s);a=w(T,"DIV",{class:!0});var k=N(a);o=w(k,"A",{href:!0});var A=N(o);f=w(A,"IMG",{src:!0,alt:!0,class:!0}),A.forEach(v),p=S(k),E=w(k,"P",{});var M=N(E);y=w(M,"A",{href:!0});var X=N(y);g=F(X,n),X.forEach(v),M.forEach(v),k.forEach(v),T.forEach(v),r=S(I),u=w(I,"P",{class:!0});var J=N(u);c=F(J,l),J.forEach(v),q=S(I),I.forEach(v),this.h()},h(){var b,I,T;W(f.src,d=((b=i[3][i[14].id])==null?void 0:b.profile_picture)||"https://via.placeholder.com/150")||m(f,"src",d),m(f,"alt","Avatar"),m(f,"class","avatar svelte-1qalp6p"),m(o,"href",_="/usuario/"+((I=i[3][i[14].id])==null?void 0:I.id)),m(y,"href",t="./"+((T=i[3][i[14].id])==null?void 0:T.id)),m(a,"class","info_usuario svelte-1qalp6p"),m(s,"class","usuario"),m(u,"class","texto svelte-1qalp6p"),m(e,"class","comentario svelte-1qalp6p")},m(b,I){P(b,e,I),h(e,s),h(s,a),h(a,o),h(o,f),h(a,p),h(a,E),h(E,y),h(y,g),h(e,r),h(e,u),h(u,c),h(e,q)},p(b,I){var T,k,A,M;I&12&&!W(f.src,d=((T=b[3][b[14].id])==null?void 0:T.profile_picture)||"https://via.placeholder.com/150")&&m(f,"src",d),I&12&&_!==(_="/usuario/"+((k=b[3][b[14].id])==null?void 0:k.id))&&m(o,"href",_),I&12&&n!==(n=((A=b[3][b[14].id])==null?void 0:A.name)+"")&&G(g,n),I&12&&t!==(t="./"+((M=b[3][b[14].id])==null?void 0:M.id))&&m(y,"href",t),I&4&&l!==(l=b[14].content+"")&&G(c,l)},d(b){b&&v(e)}}}function Ce(i){let e,s,a,o,f,d,_="Submit Comment",p,E,y,n=i[1]&&x(i),g=Z(i[2]),t=[];for(let r=0;r<g.length;r+=1)t[r]=ee($(i,g,r));return{c(){e=C("section"),s=C("form"),n&&n.c(),a=O(),o=C("textarea"),f=O(),d=C("button"),d.textContent=_,p=O();for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=w(r,"SECTION",{});var u=N(e);s=w(u,"FORM",{class:!0});var l=N(s);n&&n.l(l),a=S(l),o=w(l,"TEXTAREA",{placeholder:!0,rows:!0,class:!0}),N(o).forEach(v),f=S(l),d=w(l,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),ae(d)!=="svelte-1yb9p2g"&&(d.textContent=_),l.forEach(v),p=S(u);for(let c=0;c<t.length;c+=1)t[c].l(u);u.forEach(v),this.h()},h(){m(o,"placeholder","Write a comment..."),m(o,"rows","3"),m(o,"class","comment-input svelte-1qalp6p"),m(d,"type","submit"),m(d,"class","submit-btn svelte-1qalp6p"),m(s,"class","svelte-1qalp6p")},m(r,u){P(r,e,u),h(e,s),n&&n.m(s,null),h(s,a),h(s,o),K(o,i[4]),h(s,f),h(s,d),h(e,p);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(e,null);E||(y=[Q(o,"input",i[7]),Q(s,"submit",ie(i[5]))],E=!0)},p(r,[u]){if(r[1]?n?n.p(r,u):(n=x(r),n.c(),n.m(s,a)):n&&(n.d(1),n=null),u&16&&K(o,r[4]),u&12){g=Z(r[2]);let l;for(l=0;l<g.length;l+=1){const c=$(r,g,l);t[l]?t[l].p(c,u):(t[l]=ee(c),t[l].c(),t[l].m(e,null))}for(;l<t.length;l+=1)t[l].d(1);t.length=g.length}},i:L,o:L,d(r){r&&v(e),n&&n.d(),ce(t,r),E=!1,ne(y)}}}function we(i,e,s){let{id:a}=e,o=[],f=null,d={},_,p,E;le(async()=>{try{if(_=localStorage.getItem("token"),_){const c=JSON.parse(localStorage.getItem("user")||"");p=c?me.fromObject(c):null,p&&(E=p.id)}if(f=await he(a),f&&(s(2,o=await de(f.comentarios)),o)){for(const c of o)if(!d[c.id]){let q=await y(c.user);q&&s(3,d[c.id]=q,d)}}}catch(c){console.error("Failed to fetch review data:",c)}});async function y(c){try{return await _e(c)}catch(q){return console.error(`Error fetching user ${c}:`,q),null}}let n="",g,{messageColor:t="red"}=e,{message:r=""}=e;async function u(){try{if(s(4,n=n.trim()),f&&E&&_&&(n.length>0||n.length<ve))g=new pe("",n,E,new Date(Date.now()),f.id),s(4,n="");else{s(0,t="red"),s(1,r="Please enter a valid comment.");return}await ge(g,_)&&(s(0,t="green"),s(1,r="Comment submitted successfully!"),s(4,n=""))}catch(c){console.error("Error submitting review:",c),s(0,t="red"),s(1,r="An error occurred while submitting the review.")}}function l(){n=this.value,s(4,n)}return i.$$set=c=>{"id"in c&&s(6,a=c.id),"messageColor"in c&&s(0,t=c.messageColor),"message"in c&&s(1,r=c.message)},[t,r,o,d,n,u,a,l]}class Ee extends se{constructor(e){super(),re(this,e,we,Ce,te,{id:6,messageColor:0,message:1})}}function ye(i){let e,s,a,o,f,d,_,p,E="Comentarios",y,n,g;return e=new fe({}),f=new ue({props:{id:i[0].id}}),n=new Ee({props:{id:i[0].id}}),{c(){R(e.$$.fragment),s=O(),a=C("main"),o=C("section"),R(f.$$.fragment),d=O(),_=C("section"),p=C("h2"),p.textContent=E,y=O(),R(n.$$.fragment),this.h()},l(t){U(e.$$.fragment,t),s=S(t),a=w(t,"MAIN",{class:!0});var r=N(a);o=w(r,"SECTION",{class:!0,id:!0});var u=N(o);U(f.$$.fragment,u),u.forEach(v),d=S(r),_=w(r,"SECTION",{class:!0,id:!0});var l=N(_);p=w(l,"H2",{class:!0,"data-svelte-h":!0}),ae(p)!=="svelte-2iqkaf"&&(p.textContent=E),y=S(l),U(n.$$.fragment,l),l.forEach(v),r.forEach(v),this.h()},h(){m(o,"class","section-body"),m(o,"id","albums-recientes"),m(p,"class","section-title"),m(_,"class","section-body"),m(_,"id","albums-populares"),m(a,"class","svelte-1go1nic")},m(t,r){j(e,t,r),P(t,s,r),P(t,a,r),h(a,o),j(f,o,null),h(a,d),h(a,_),h(_,p),h(_,y),j(n,_,null),g=!0},p(t,[r]){const u={};r&1&&(u.id=t[0].id),f.$set(u);const l={};r&1&&(l.id=t[0].id),n.$set(l)},i(t){g||(B(e.$$.fragment,t),B(f.$$.fragment,t),B(n.$$.fragment,t),g=!0)},o(t){D(e.$$.fragment,t),D(f.$$.fragment,t),D(n.$$.fragment,t),g=!1},d(t){t&&(v(s),v(a)),V(e,t),V(f),V(n)}}}function Ie(i,e,s){let{data:a}=e;return i.$$set=o=>{"data"in o&&s(0,a=o.data)},[a]}class Pe extends se{constructor(e){super(),re(this,e,Ie,ye,te,{data:0})}}export{Pe as component,Me as universal};
