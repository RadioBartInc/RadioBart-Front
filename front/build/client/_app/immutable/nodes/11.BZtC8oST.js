import{e as ie}from"../chunks/index.CzR0xuCU.js";import{s as oe,n as H,o as ce,d as Z,r as ue}from"../chunks/scheduler.Cz3TSd7V.js";import{S as ae,i as le,e as w,s as N,c as E,d as q,h as O,g,j as S,k as _,u as fe,b as L,f as X,o as h,l as J,A as U,B as $,z as W,E as me,C as x,m as D,n as R,p as V,t as z,a as F,r as G}from"../chunks/index.DKOtY3uX.js";import{e as ee,N as de}from"../chunks/Navbar.DGiOEIBM.js";import{R as he}from"../chunks/Review.Die6Q31A.js";import{U as _e,a as pe,o as ge,b as ve,C as be,q as Ce,s as we}from"../chunks/APIAdapter.DEoGsArP.js";import{M as Ee}from"../chunks/limits.C1Ngrwk2.js";function ke({params:n}){if(n.id)return{id:n.id};ie(404,"Not found")}const Re=Object.freeze(Object.defineProperty({__proto__:null,load:ke},Symbol.toStringTag,{value:"Module"}));function te(n,e,s){const t=n.slice();return t[16]=e[s],t}function ye(n){let e,s="Logeate para escribir un mensaje";return{c(){e=w("p"),e.textContent=s,this.h()},l(t){e=E(t,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-u3tstx"&&(e.textContent=s),this.h()},h(){h(e,"class","comment-input not-logged svelte-128cqib")},m(t,l){S(t,e,l)},p:H,d(t){t&&g(e)}}}function qe(n){let e,s,t,l,r,m="Submit Comment",o,i,c=n[1]&&se(n);return{c(){e=w("form"),c&&c.c(),s=N(),t=w("textarea"),l=N(),r=w("button"),r.textContent=m,this.h()},l(a){e=E(a,"FORM",{class:!0});var u=q(e);c&&c.l(u),s=O(u),t=E(u,"TEXTAREA",{placeholder:!0,rows:!0,class:!0}),q(t).forEach(g),l=O(u),r=E(u,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),U(r)!=="svelte-1yb9p2g"&&(r.textContent=m),u.forEach(g),this.h()},h(){h(t,"placeholder","Write a comment..."),h(t,"rows","3"),h(t,"class","comment-input svelte-128cqib"),h(r,"type","submit"),h(r,"class","submit-btn svelte-128cqib"),h(e,"class","svelte-128cqib")},m(a,u){S(a,e,u),c&&c.m(e,null),_(e,s),_(e,t),$(t,n[6]),_(e,l),_(e,r),o||(i=[W(t,"input",n[10]),W(e,"submit",me(n[7]))],o=!0)},p(a,u){a[1]?c?c.p(a,u):(c=se(a),c.c(),c.m(e,s)):c&&(c.d(1),c=null),u&64&&$(t,a[6])},d(a){a&&g(e),c&&c.d(),o=!1,ue(i)}}}function se(n){let e,s;return{c(){e=w("p"),s=L(n[1]),this.h()},l(t){e=E(t,"P",{class:!0,style:!0});var l=q(e);s=X(l,n[1]),l.forEach(g),this.h()},h(){h(e,"class","submission-message"),x(e,"color",n[0])},m(t,l){S(t,e,l),_(e,s)},p(t,l){l&2&&J(s,t[1]),l&1&&x(e,"color",t[0])},d(t){t&&g(e)}}}function re(n){let e,s="Borrar Comentario",t,l;function r(){return n[11](n[16])}return{c(){e=w("button"),e.textContent=s,this.h()},l(m){e=E(m,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1qipujq"&&(e.textContent=s),this.h()},h(){h(e,"class","admin-button bg-red svelte-128cqib")},m(m,o){S(m,e,o),t||(l=W(e,"click",r),t=!0)},p(m,o){n=m},d(m){m&&g(e),t=!1,l()}}}function ne(n){var K;let e,s,t,l,r,m,o,i,c,a,u=((K=n[3][n[16].id])==null?void 0:K.name)+"",I,f,v,y,k=n[16].content+"",M,j,d,b=n[5]&&n[5].role&&re(n);return{c(){e=w("div"),s=w("div"),t=w("div"),l=w("a"),r=w("img"),i=N(),c=w("p"),a=w("a"),I=L(u),v=N(),y=w("p"),M=L(k),j=N(),b&&b.c(),d=N(),this.h()},l(p){e=E(p,"DIV",{class:!0});var C=q(e);s=E(C,"DIV",{class:!0});var T=q(s);t=E(T,"DIV",{class:!0});var A=q(t);l=E(A,"A",{href:!0});var B=q(l);r=E(B,"IMG",{src:!0,alt:!0,class:!0}),B.forEach(g),i=O(A),c=E(A,"P",{});var P=q(c);a=E(P,"A",{href:!0});var Q=q(a);I=X(Q,u),Q.forEach(g),P.forEach(g),A.forEach(g),T.forEach(g),v=O(C),y=E(C,"P",{class:!0});var Y=q(y);M=X(Y,k),Y.forEach(g),j=O(C),b&&b.l(C),d=O(C),C.forEach(g),this.h()},h(){var p,C,T;Z(r.src,m=((p=n[3][n[16].id])==null?void 0:p.profile_picture)||"https://via.placeholder.com/150")||h(r,"src",m),h(r,"alt","Avatar"),h(r,"class","avatar svelte-128cqib"),h(l,"href",o="/usuario/"+((C=n[3][n[16].id])==null?void 0:C.id)),h(a,"href",f="./"+((T=n[3][n[16].id])==null?void 0:T.id)),h(t,"class","info_usuario svelte-128cqib"),h(s,"class","usuario"),h(y,"class","texto svelte-128cqib"),h(e,"class","comentario svelte-128cqib")},m(p,C){S(p,e,C),_(e,s),_(s,t),_(t,l),_(l,r),_(t,i),_(t,c),_(c,a),_(a,I),_(e,v),_(e,y),_(y,M),_(e,j),b&&b.m(e,null),_(e,d)},p(p,C){var T,A,B,P;C&12&&!Z(r.src,m=((T=p[3][p[16].id])==null?void 0:T.profile_picture)||"https://via.placeholder.com/150")&&h(r,"src",m),C&12&&o!==(o="/usuario/"+((A=p[3][p[16].id])==null?void 0:A.id))&&h(l,"href",o),C&12&&u!==(u=((B=p[3][p[16].id])==null?void 0:B.name)+"")&&J(I,u),C&12&&f!==(f="./"+((P=p[3][p[16].id])==null?void 0:P.id))&&h(a,"href",f),C&4&&k!==(k=p[16].content+"")&&J(M,k),p[5]&&p[5].role?b?b.p(p,C):(b=re(p),b.c(),b.m(e,d)):b&&(b.d(1),b=null)},d(p){p&&g(e),b&&b.d()}}}function Ie(n){let e,s;function t(i,c){return i[4]?qe:ye}let l=t(n),r=l(n),m=ee(n[2]),o=[];for(let i=0;i<m.length;i+=1)o[i]=ne(te(n,m,i));return{c(){e=w("section"),r.c(),s=N();for(let i=0;i<o.length;i+=1)o[i].c()},l(i){e=E(i,"SECTION",{});var c=q(e);r.l(c),s=O(c);for(let a=0;a<o.length;a+=1)o[a].l(c);c.forEach(g)},m(i,c){S(i,e,c),r.m(e,null),_(e,s);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null)},p(i,[c]){if(l===(l=t(i))&&r?r.p(i,c):(r.d(1),r=l(i),r&&(r.c(),r.m(e,s))),c&300){m=ee(i[2]);let a;for(a=0;a<m.length;a+=1){const u=te(i,m,a);o[a]?o[a].p(u,c):(o[a]=ne(u),o[a].c(),o[a].m(e,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=m.length}},i:H,o:H,d(i){i&&g(e),r.d(),fe(o,i)}}}function Ne(n,e,s){let{id:t}=e,l=[],r=null,m={},o,i,c;ce(async()=>{try{if(s(4,o=localStorage.getItem("token")),o){const d=JSON.parse(localStorage.getItem("user")||"{}");s(5,i=d?_e.fromObject(d):null),i&&(c=i.id)}if(r=await pe(t),r&&(s(2,l=await ge(r.comentarios)),l)){for(const d of l)if(!m[d.id]){let b=await a(d.user);b&&s(3,m[d.id]=b,m)}}}catch(d){console.error("Failed to fetch review data:",d)}});async function a(d){try{return await ve(d)}catch(b){return console.error(`Error fetching user ${d}:`,b),null}}let u="",I,{messageColor:f="red"}=e,{message:v=""}=e;async function y(){try{if(s(6,u=u.trim()),r&&c&&o&&(u.length>0||u.length<Ee))I=new be("",u,c,new Date(Date.now()),r.id),s(6,u="");else{s(0,f="red"),s(1,v="Please enter a valid comment.");return}await Ce(I,o)&&(s(0,f="green"),s(1,v="Comment submitted successfully!"),s(6,u=""))}catch(d){console.error("Error submitting review:",d),s(0,f="red"),s(1,v="An error occurred while submitting the review.")}}async function k(d){await we(d,o??""),window.location.reload()}function M(){u=this.value,s(6,u)}const j=d=>k(d.id);return n.$$set=d=>{"id"in d&&s(9,t=d.id),"messageColor"in d&&s(0,f=d.messageColor),"message"in d&&s(1,v=d.message)},[f,v,l,m,o,i,u,y,k,t,M,j]}class Oe extends ae{constructor(e){super(),le(this,e,Ne,Ie,oe,{id:9,messageColor:0,message:1})}}function Te(n){let e,s,t,l,r,m,o,i,c="Comentarios",a,u,I;return e=new de({}),r=new he({props:{id:n[0].id}}),u=new Oe({props:{id:n[0].id}}),{c(){D(e.$$.fragment),s=N(),t=w("main"),l=w("section"),D(r.$$.fragment),m=N(),o=w("section"),i=w("h2"),i.textContent=c,a=N(),D(u.$$.fragment),this.h()},l(f){R(e.$$.fragment,f),s=O(f),t=E(f,"MAIN",{class:!0});var v=q(t);l=E(v,"SECTION",{class:!0,id:!0});var y=q(l);R(r.$$.fragment,y),y.forEach(g),m=O(v),o=E(v,"SECTION",{class:!0,id:!0});var k=q(o);i=E(k,"H2",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-2iqkaf"&&(i.textContent=c),a=O(k),R(u.$$.fragment,k),k.forEach(g),v.forEach(g),this.h()},h(){h(l,"class","section-body"),h(l,"id","albums-recientes"),h(i,"class","section-title"),h(o,"class","section-body"),h(o,"id","albums-populares"),h(t,"class","svelte-7qonsc")},m(f,v){V(e,f,v),S(f,s,v),S(f,t,v),_(t,l),V(r,l,null),_(t,m),_(t,o),_(o,i),_(o,a),V(u,o,null),I=!0},p(f,[v]){const y={};v&1&&(y.id=f[0].id),r.$set(y);const k={};v&1&&(k.id=f[0].id),u.$set(k)},i(f){I||(z(e.$$.fragment,f),z(r.$$.fragment,f),z(u.$$.fragment,f),I=!0)},o(f){F(e.$$.fragment,f),F(r.$$.fragment,f),F(u.$$.fragment,f),I=!1},d(f){f&&(g(s),g(t)),G(e,f),G(r),G(u)}}}function Se(n,e,s){let{data:t}=e;return n.$$set=l=>{"data"in l&&s(0,t=l.data)},[t]}class Ve extends ae{constructor(e){super(),le(this,e,Se,Te,oe,{data:0})}}export{Ve as component,Re as universal};
