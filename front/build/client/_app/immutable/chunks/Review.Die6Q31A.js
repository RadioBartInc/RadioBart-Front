import{s as Ze,n as Be,o as ye,d as de}from"./scheduler.Cz3TSd7V.js";import{S as $e,i as xe,e as n,c,d as h,g as u,o as l,j as X,s as k,b as H,x as Fe,h as I,f as j,y as Ge,k as s,z as Xe,l as z,A as Ye}from"./index.DKOtY3uX.js";import{g as et}from"./entry.XM5ONYRv.js";import{U as tt,a as lt,b as st,c as at,d as rt,u as it,e as ot}from"./APIAdapter.DEoGsArP.js";import{g as Je}from"./misc.B4lJbiPP.js";function Ke(a){let e,t,i,v,f,d,b,B,S=a[4].name+"",w,U,R,T,D,O=a[3].title+"",m,te,me,q,L,Y=a[1].ratingScore+"",le,se,_e,F,Z=a[1].fecha.toLocaleDateString("es-ES")+"",ae,ge,re,M,G,A,V,C,ie,oe,pe,y,N,$=a[2].name+"",fe,ue,be,E,P,p,x,ne,we,J,ce,Ee,ke,K,ee=a[1].content+"",he,Ie,Se,_=a[7]&&a[7].role&&Qe(a),g=a[0]&&We(a);return{c(){e=n("div"),t=n("a"),i=n("img"),d=k(),b=n("h3"),B=n("a"),w=H(S),R=k(),T=n("h3"),D=n("a"),m=H(O),me=k(),q=n("div"),L=n("p"),le=H(Y),_e=k(),F=n("p"),ae=H(Z),ge=k(),_&&_.c(),re=k(),M=n("div"),G=n("div"),A=n("div"),V=n("a"),C=n("img"),pe=k(),y=n("p"),N=n("a"),fe=H($),be=k(),E=n("div"),P=n("button"),p=Fe("svg"),x=Fe("path"),we=k(),J=n("p"),ce=H(a[5]),Ee=k(),g&&g.c(),ke=k(),K=n("p"),he=H(ee),this.h()},l(o){e=c(o,"DIV",{class:!0});var r=h(e);t=c(r,"A",{href:!0});var Ae=h(t);i=c(Ae,"IMG",{src:!0,alt:!0,class:!0}),Ae.forEach(u),d=I(r),b=c(r,"H3",{class:!0});var De=h(b);B=c(De,"A",{href:!0});var Me=h(B);w=j(Me,S),Me.forEach(u),De.forEach(u),R=I(r),T=c(r,"H3",{class:!0});var Ce=h(T);D=c(Ce,"A",{href:!0});var Re=h(D);m=j(Re,O),Re.forEach(u),Ce.forEach(u),me=I(r),q=c(r,"DIV",{class:!0});var Te=h(q);L=c(Te,"P",{class:!0});var Ue=h(L);le=j(Ue,Y),Ue.forEach(u),Te.forEach(u),_e=I(r),F=c(r,"P",{class:!0});var Oe=h(F);ae=j(Oe,Z),Oe.forEach(u),ge=I(r),_&&_.l(r),r.forEach(u),re=I(o),M=c(o,"DIV",{class:!0});var ve=h(M);G=c(ve,"DIV",{class:!0});var Le=h(G);A=c(Le,"DIV",{class:!0});var Q=h(A);V=c(Q,"A",{href:!0});var Ve=h(V);C=c(Ve,"IMG",{src:!0,alt:!0,class:!0}),Ve.forEach(u),pe=I(Q),y=c(Q,"P",{});var Ne=h(y);N=c(Ne,"A",{href:!0});var Pe=h(N);fe=j(Pe,$),Pe.forEach(u),Ne.forEach(u),be=I(Q),E=c(Q,"DIV",{class:!0});var W=h(E);P=c(W,"BUTTON",{class:!0});var He=h(P);p=Ge(He,"svg",{class:!0,height:!0,fill:!0,viewBox:!0,width:!0,xmlns:!0});var je=h(p);x=Ge(je,"path",{d:!0}),h(x).forEach(u),je.forEach(u),He.forEach(u),we=I(W),J=c(W,"P",{class:!0});var ze=h(J);ce=j(ze,a[5]),ze.forEach(u),Ee=I(W),g&&g.l(W),W.forEach(u),Q.forEach(u),Le.forEach(u),ke=I(ve),K=c(ve,"P",{class:!0});var qe=h(K);he=j(qe,ee),qe.forEach(u),ve.forEach(u),this.h()},h(){de(i.src,v=a[3].cover)||l(i,"src",v),l(i,"alt","Album Cover"),l(i,"class","portada hover-image svelte-d1mgxb"),l(t,"href",f=`/album/${a[3].id}`),l(B,"href",U=`/artista/${a[4].id}`),l(b,"class","artista svelte-d1mgxb"),l(D,"href",te=`/album/${a[3].id}`),l(T,"class","album svelte-d1mgxb"),l(L,"class",se="rating "+Je(a[1].ratingScore)+" svelte-d1mgxb"),l(q,"class","rating-wrapper svelte-d1mgxb"),l(F,"class","fecha svelte-d1mgxb"),l(e,"class","info svelte-d1mgxb"),de(C.src,ie=a[2].profile_picture||"https://via.placeholder.com/50")||l(C,"src",ie),l(C,"alt","User Avatar"),l(C,"class","avatar svelte-d1mgxb"),l(V,"href",oe=`/usuario/${a[2].id}`),l(N,"href",ue=`/usuario/${a[2].id}`),l(x,"d","m248.367188 448.496094c2.359374 1.394531 4.996093 2.082031 7.632812 2.082031s5.273438-.6875 7.632812-2.082031c10.398438-6.152344 255.613282-152.242188 248.203126-309.316406-3.632813-77.175782-63.378907-138.078126-134.769532-138.648438-61.941406-1.390625-100.558594 42.121094-121.066406 80.53125-20.40625-38.191406-59.363281-80.53125-120.042969-80.53125-.351562 0-.6875 0-1.023437 0-71.390625.574219-131.136719 61.472656-134.769532 138.648438-7.410156 157.074218 237.800782 303.164062 248.203126 309.316406zm0 0"),l(p,"class","heart svelte-d1mgxb"),l(p,"height","20px"),l(p,"fill",ne=a[6]?"#ff6666":"#222"),l(p,"viewBox","0 -30 511.99938 511"),l(p,"width","20px"),l(p,"xmlns","http://www.w3.org/2000/svg"),l(P,"class","like-button svelte-d1mgxb"),l(J,"class","likes-no svelte-d1mgxb"),l(E,"class","likes svelte-d1mgxb"),l(A,"class","info_usuario svelte-d1mgxb"),l(G,"class","usuario"),l(K,"class","review-texto svelte-d1mgxb"),l(M,"class","review svelte-d1mgxb")},m(o,r){X(o,e,r),s(e,t),s(t,i),s(e,d),s(e,b),s(b,B),s(B,w),s(e,R),s(e,T),s(T,D),s(D,m),s(e,me),s(e,q),s(q,L),s(L,le),s(e,_e),s(e,F),s(F,ae),s(e,ge),_&&_.m(e,null),X(o,re,r),X(o,M,r),s(M,G),s(G,A),s(A,V),s(V,C),s(A,pe),s(A,y),s(y,N),s(N,fe),s(A,be),s(A,E),s(E,P),s(P,p),s(p,x),s(E,we),s(E,J),s(J,ce),s(E,Ee),g&&g.m(E,null),s(M,ke),s(M,K),s(K,he),Ie||(Se=Xe(P,"click",a[8]),Ie=!0)},p(o,r){r&8&&!de(i.src,v=o[3].cover)&&l(i,"src",v),r&8&&f!==(f=`/album/${o[3].id}`)&&l(t,"href",f),r&16&&S!==(S=o[4].name+"")&&z(w,S),r&16&&U!==(U=`/artista/${o[4].id}`)&&l(B,"href",U),r&8&&O!==(O=o[3].title+"")&&z(m,O),r&8&&te!==(te=`/album/${o[3].id}`)&&l(D,"href",te),r&2&&Y!==(Y=o[1].ratingScore+"")&&z(le,Y),r&2&&se!==(se="rating "+Je(o[1].ratingScore)+" svelte-d1mgxb")&&l(L,"class",se),r&2&&Z!==(Z=o[1].fecha.toLocaleDateString("es-ES")+"")&&z(ae,Z),o[7]&&o[7].role?_?_.p(o,r):(_=Qe(o),_.c(),_.m(e,null)):_&&(_.d(1),_=null),r&4&&!de(C.src,ie=o[2].profile_picture||"https://via.placeholder.com/50")&&l(C,"src",ie),r&4&&oe!==(oe=`/usuario/${o[2].id}`)&&l(V,"href",oe),r&4&&$!==($=o[2].name+"")&&z(fe,$),r&4&&ue!==(ue=`/usuario/${o[2].id}`)&&l(N,"href",ue),r&64&&ne!==(ne=o[6]?"#ff6666":"#222")&&l(p,"fill",ne),r&32&&z(ce,o[5]),o[0]?g?g.p(o,r):(g=We(o),g.c(),g.m(E,null)):g&&(g.d(1),g=null),r&2&&ee!==(ee=o[1].content+"")&&z(he,ee)},d(o){o&&(u(e),u(re),u(M)),_&&_.d(),g&&g.d(),Ie=!1,Se()}}}function Qe(a){let e,t="Borrar Review",i,v;return{c(){e=n("button"),e.textContent=t,this.h()},l(f){e=c(f,"BUTTON",{class:!0,"data-svelte-h":!0}),Ye(e)!=="svelte-1d2zyy3"&&(e.textContent=t),this.h()},h(){l(e,"class","admin-button bg-red")},m(f,d){X(f,e,d),i||(v=Xe(e,"click",a[9]),i=!0)},p:Be,d(f){f&&u(e),i=!1,v()}}}function We(a){let e,t,i='<img src="https://via.placeholder.com/50" alt="More Review" class="svelte-d1mgxb"/>',v;return{c(){e=n("a"),t=n("button"),t.innerHTML=i,this.h()},l(f){e=c(f,"A",{class:!0,href:!0});var d=h(e);t=c(d,"BUTTON",{class:!0,"data-svelte-h":!0}),Ye(t)!=="svelte-3frthu"&&(t.innerHTML=i),d.forEach(u),this.h()},h(){l(t,"class","svelte-d1mgxb"),l(e,"class","more_review svelte-d1mgxb"),l(e,"href",v=`/review/${a[1].id}`)},m(f,d){X(f,e,d),s(e,t)},p(f,d){d&2&&v!==(v=`/review/${f[1].id}`)&&l(e,"href",v)},d(f){f&&u(e)}}}function ft(a){let e,t=a[1]&&a[3]&&a[2]&&a[4]&&Ke(a);return{c(){e=n("section"),t&&t.c(),this.h()},l(i){e=c(i,"SECTION",{class:!0});var v=h(e);t&&t.l(v),v.forEach(u),this.h()},h(){l(e,"class","svelte-d1mgxb")},m(i,v){X(i,e,v),t&&t.m(e,null)},p(i,[v]){i[1]&&i[3]&&i[2]&&i[4]?t?t.p(i,v):(t=Ke(i),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:Be,o:Be,d(i){i&&u(e),t&&t.d()}}}function ut(a,e,t){let{id:i}=e,{showMoreButton:v=!1}=e,f=null,d=null,b=null,B=null,S=0,w=!1,U,R="";async function T(){try{R=localStorage.getItem("token");const m=JSON.parse(localStorage.getItem("user")||"{}");t(7,U=m?tt.fromObject(m):null),t(1,f=await lt(i)),f&&(t(2,d=await st(f.userId)),t(3,b=await at(f.albumId)),b&&t(4,B=await rt(b.artist)),t(5,S=f.likes),t(6,w=!1))}catch(m){console.error("Failed to fetch review data:",m)}}ye(T);async function D(){if(f&&d&&R)try{await it(f.id,R,S+(w?-1:1),d.id)&&(t(5,S+=w?-1:1),t(6,w=!w))}catch(m){console.error("Failed to update like status:",m)}}async function O(){f&&await ot(f.id??"",R??""),et("/")}return a.$$set=m=>{"id"in m&&t(10,i=m.id),"showMoreButton"in m&&t(0,v=m.showMoreButton)},[v,f,d,b,B,S,w,U,D,O,i]}class mt extends $e{constructor(e){super(),xe(this,e,ut,ft,Ze,{id:10,showMoreButton:0})}}export{mt as R};
