import{s as oe,n as H,r as ue,o as he,d as W}from"../chunks/scheduler.Cz3TSd7V.js";import{S as fe,i as ce,e as k,s as R,v as X,c as z,d as y,h as T,A as _e,g,o as m,j as I,k as _,B as Y,z as U,u as me,b as M,f as S,l as D,m as Z,n as $,p as x,t as ee,a as te,r as ae}from"../chunks/index.DKOtY3uX.js";import{e as se,N as ve}from"../chunks/Navbar.DGiOEIBM.js";import{f as ge,d as de,h as be}from"../chunks/APIAdapter.DEoGsArP.js";import{g as le}from"../chunks/misc.B4lJbiPP.js";function re(r,t,e){const i=r.slice();return i[16]=t[e],i}function ne(r){var Q;let t,e,i,u,d,s,o,b,v=((Q=r[1][r[16].artist])==null?void 0:Q.name)+"",A,p,P,f,c,a=r[16].title+"",n,l,w,h,N=r[2][r[16].id]+"",C,V,q;return{c(){t=k("div"),e=k("a"),i=k("img"),s=R(),o=k("h3"),b=k("a"),A=M(v),P=R(),f=k("h3"),c=k("a"),n=M(a),w=R(),h=k("p"),C=M(N),q=R(),this.h()},l(j){t=z(j,"DIV",{class:!0});var E=y(t);e=z(E,"A",{href:!0});var O=y(e);i=z(O,"IMG",{src:!0,alt:!0,class:!0}),O.forEach(g),s=T(E),o=z(E,"H3",{class:!0});var F=y(o);b=z(F,"A",{href:!0});var G=y(b);A=S(G,v),G.forEach(g),F.forEach(g),P=T(E),f=z(E,"H3",{class:!0});var K=y(f);c=z(K,"A",{href:!0});var J=y(c);n=S(J,a),J.forEach(g),K.forEach(g),w=T(E),h=z(E,"P",{class:!0});var L=y(h);C=S(L,N),L.forEach(g),q=T(E),E.forEach(g),this.h()},h(){W(i.src,u=r[16].cover||"https://via.placeholder.com/150")||m(i,"src",u),m(i,"alt","album_cover"),m(i,"class","portada hover-image svelte-uj6a8z"),m(e,"href",d=`/album/${r[16].id}`),m(b,"href",p=`/artista/${r[16].artist}`),m(o,"class","artista svelte-uj6a8z"),m(c,"href",l=`/album/${r[16].id}`),m(f,"class","nombre_album svelte-uj6a8z"),m(h,"class",V="rating "+le(r[2][r[16].id])+" svelte-uj6a8z"),m(t,"class","album svelte-uj6a8z")},m(j,E){I(j,t,E),_(t,e),_(e,i),_(t,s),_(t,o),_(o,b),_(b,A),_(t,P),_(t,f),_(f,c),_(c,n),_(t,w),_(t,h),_(h,C),_(t,q)},p(j,E){var O;E&1&&!W(i.src,u=j[16].cover||"https://via.placeholder.com/150")&&m(i,"src",u),E&1&&d!==(d=`/album/${j[16].id}`)&&m(e,"href",d),E&3&&v!==(v=((O=j[1][j[16].artist])==null?void 0:O.name)+"")&&D(A,v),E&1&&p!==(p=`/artista/${j[16].artist}`)&&m(b,"href",p),E&1&&a!==(a=j[16].title+"")&&D(n,a),E&1&&l!==(l=`/album/${j[16].id}`)&&m(c,"href",l),E&5&&N!==(N=j[2][j[16].id]+"")&&D(C,N),E&5&&V!==(V="rating "+le(j[2][j[16].id])+" svelte-uj6a8z")&&m(h,"class",V)},d(j){j&&g(t)}}}function ie(r){let t,e,i,u,d,s,o,b,v,A,p,P,f,c,a;return{c(){t=k("div"),e=k("button"),i=M("Previous"),d=R(),s=k("p"),o=M(r[3]),b=M(" of "),v=M(r[5]),A=R(),p=k("button"),P=M("Next"),this.h()},l(n){t=z(n,"DIV",{class:!0});var l=y(t);e=z(l,"BUTTON",{class:!0});var w=y(e);i=S(w,"Previous"),w.forEach(g),d=T(l),s=z(l,"P",{class:!0});var h=y(s);o=S(h,r[3]),b=S(h," of "),v=S(h,r[5]),h.forEach(g),A=T(l),p=z(l,"BUTTON",{class:!0});var N=y(p);P=S(N,"Next"),N.forEach(g),l.forEach(g),this.h()},h(){e.disabled=u=r[3]===1,m(e,"class","svelte-uj6a8z"),m(s,"class","svelte-uj6a8z"),p.disabled=f=r[3]===r[5],m(p,"class","svelte-uj6a8z"),m(t,"class","pagination svelte-uj6a8z")},m(n,l){I(n,t,l),_(t,e),_(e,i),_(t,d),_(t,s),_(s,o),_(s,b),_(s,v),_(t,A),_(t,p),_(p,P),c||(a=[U(e,"click",r[11]),U(p,"click",r[12])],c=!0)},p(n,l){l&8&&u!==(u=n[3]===1)&&(e.disabled=u),l&8&&D(o,n[3]),l&32&&D(v,n[5]),l&40&&f!==(f=n[3]===n[5])&&(p.disabled=f)},d(n){n&&g(t),c=!1,ue(a)}}}function pe(r){let t,e,i,u,d="Search",s,o,b,v,A,p,P=se(r[0]),f=[];for(let a=0;a<P.length;a+=1)f[a]=ne(re(r,P,a));let c=r[4]>B&&ie(r);return{c(){t=k("div"),e=k("input"),i=R(),u=k("button"),u.textContent=d,s=R(),o=k("section");for(let a=0;a<f.length;a+=1)f[a].c();b=R(),c&&c.c(),v=X(),this.h()},l(a){t=z(a,"DIV",{class:!0});var n=y(t);e=z(n,"INPUT",{type:!0,placeholder:!0,class:!0}),i=T(n),u=z(n,"BUTTON",{"data-svelte-h":!0}),_e(u)!=="svelte-1w1tdxi"&&(u.textContent=d),n.forEach(g),s=T(a),o=z(a,"SECTION",{class:!0});var l=y(o);for(let w=0;w<f.length;w+=1)f[w].l(l);l.forEach(g),b=T(a),c&&c.l(a),v=X(),this.h()},h(){m(e,"type","text"),m(e,"placeholder","Search albums or artists..."),m(e,"class","svelte-uj6a8z"),m(t,"class","search-bar svelte-uj6a8z"),m(o,"class","svelte-uj6a8z")},m(a,n){I(a,t,n),_(t,e),Y(e,r[6]),_(t,i),_(t,u),I(a,s,n),I(a,o,n);for(let l=0;l<f.length;l+=1)f[l]&&f[l].m(o,null);I(a,b,n),c&&c.m(a,n),I(a,v,n),A||(p=[U(e,"input",r[10]),U(e,"keypress",r[8]),U(u,"click",r[7])],A=!0)},p(a,[n]){if(n&64&&e.value!==a[6]&&Y(e,a[6]),n&7){P=se(a[0]);let l;for(l=0;l<P.length;l+=1){const w=re(a,P,l);f[l]?f[l].p(w,n):(f[l]=ne(w),f[l].c(),f[l].m(o,null))}for(;l<f.length;l+=1)f[l].d(1);f.length=P.length}a[4]>B?c?c.p(a,n):(c=ie(a),c.c(),c.m(v.parentNode,v)):c&&(c.d(1),c=null)},i:H,o:H,d(a){a&&(g(t),g(s),g(o),g(b),g(v)),me(f,a),c&&c.d(a),A=!1,ue(p)}}}let B=8;function Ee(r,t,e){let{albums:i=[]}=t,{artists:u={}}=t,{avgRatings:d={}}=t,s=1,o=1,b=Math.ceil(o/B),v="",A=!1;async function p(h){console.log("page: "+h+" perPage: "+B+" searchQuery: "+v);let N=await ge(h,B,v);e(0,i=N[0]),e(4,o=N[1]),e(5,b=Math.ceil(o/B)),e(1,u={}),e(2,d={});for(const C of i)e(1,u[C.artist]=await P(C.artist),u),e(2,d[C.id]=await f(C.id),d)}he(async()=>{await p(s),e(4,o=i.length),e(5,b=Math.ceil(o/B))});async function P(h){try{return await de(h)}catch(N){return console.error(`Error fetching artist ${h}:`,N),null}}async function f(h){try{return await be(h)||0}catch(N){return console.error(`Error fetching average rating for album ${h}:`,N),0}}function c(){s!=1?e(3,s=1):e(9,A=!0)}function a(h){h.key==="Enter"&&c()}function n(){v=this.value,e(6,v)}const l=()=>e(3,s-=1),w=()=>e(3,s+=1);return r.$$set=h=>{"albums"in h&&e(0,i=h.albums),"artists"in h&&e(1,u=h.artists),"avgRatings"in h&&e(2,d=h.avgRatings)},r.$$.update=()=>{r.$$.dirty&568&&(p(s),e(9,A=!1))},[i,u,d,s,o,b,v,c,a,A,n,l,w]}class je extends fe{constructor(t){super(),ce(this,t,Ee,pe,oe,{albums:0,artists:1,avgRatings:2})}}function ke(r){let t,e,i,u,d;return t=new ve({}),u=new je({}),{c(){Z(t.$$.fragment),e=R(),i=k("main"),Z(u.$$.fragment),this.h()},l(s){$(t.$$.fragment,s),e=T(s),i=z(s,"MAIN",{class:!0});var o=y(i);$(u.$$.fragment,o),o.forEach(g),this.h()},h(){m(i,"class","svelte-t5foe7")},m(s,o){x(t,s,o),I(s,e,o),I(s,i,o),x(u,i,null),d=!0},p:H,i(s){d||(ee(t.$$.fragment,s),ee(u.$$.fragment,s),d=!0)},o(s){te(t.$$.fragment,s),te(u.$$.fragment,s),d=!1},d(s){s&&(g(e),g(i)),ae(t,s),ae(u)}}}class ye extends fe{constructor(t){super(),ce(this,t,null,ke,oe,{})}}export{ye as component};
