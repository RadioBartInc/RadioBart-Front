import{s as se,n as G,o as ne,d as L}from"../chunks/scheduler.Cz3TSd7V.js";import{S as re,i as le,e as g,c as v,d,g as m,o as u,j as $,u as ie,s as z,b as j,h as k,f as B,k as h,l as D,m as Q,n as U,p as W,t as X,a as Y,r as Z}from"../chunks/index.DKOtY3uX.js";import{e as x,N as oe}from"../chunks/Navbar.CYHUjA86.js";import{e as ce,d as fe,f as ue}from"../chunks/APIAdapter.CWbTadu6.js";import{g as ee}from"../chunks/misc.B4lJbiPP.js";function te(i,a,r){const t=i.slice();return t[5]=a[r],t}function ae(i){var O;let a,r,t,s,n,e,c,l,_=((O=i[1][i[5].artist])==null?void 0:O.name)+"",N,y,q,A,b,E=i[5].title+"",C,I,H,p,w=i[2][i[5].id]+"",M,S,P;return{c(){a=g("div"),r=g("a"),t=g("img"),e=z(),c=g("h3"),l=g("a"),N=j(_),q=z(),A=g("h3"),b=g("a"),C=j(E),H=z(),p=g("p"),M=j(w),P=z(),this.h()},l(f){a=v(f,"DIV",{class:!0});var o=d(a);r=v(o,"A",{href:!0});var R=d(r);t=v(R,"IMG",{src:!0,alt:!0,class:!0}),R.forEach(m),e=k(o),c=v(o,"H3",{class:!0});var T=d(c);l=v(T,"A",{href:!0});var V=d(l);N=B(V,_),V.forEach(m),T.forEach(m),q=k(o),A=v(o,"H3",{class:!0});var F=d(A);b=v(F,"A",{href:!0});var J=d(b);C=B(J,E),J.forEach(m),F.forEach(m),H=k(o),p=v(o,"P",{class:!0});var K=d(p);M=B(K,w),K.forEach(m),P=k(o),o.forEach(m),this.h()},h(){L(t.src,s=i[5].cover||"https://via.placeholder.com/150")||u(t,"src",s),u(t,"alt","album_cover"),u(t,"class","portada hover-image"),u(r,"href",n=`/album/${i[5].id}`),u(l,"href",y=`/artista/${i[5].artist}`),u(c,"class","artista svelte-v74z6n"),u(b,"href",I=`/album/${i[5].id}`),u(A,"class","nombre_album svelte-v74z6n"),u(p,"class",S="rating "+ee(i[2][i[5].id])+" svelte-v74z6n"),u(a,"class","album svelte-v74z6n")},m(f,o){$(f,a,o),h(a,r),h(r,t),h(a,e),h(a,c),h(c,l),h(l,N),h(a,q),h(a,A),h(A,b),h(b,C),h(a,H),h(a,p),h(p,M),h(a,P)},p(f,o){var R;o&1&&!L(t.src,s=f[5].cover||"https://via.placeholder.com/150")&&u(t,"src",s),o&1&&n!==(n=`/album/${f[5].id}`)&&u(r,"href",n),o&3&&_!==(_=((R=f[1][f[5].artist])==null?void 0:R.name)+"")&&D(N,_),o&1&&y!==(y=`/artista/${f[5].artist}`)&&u(l,"href",y),o&1&&E!==(E=f[5].title+"")&&D(C,E),o&1&&I!==(I=`/album/${f[5].id}`)&&u(b,"href",I),o&5&&w!==(w=f[2][f[5].id]+"")&&D(M,w),o&5&&S!==(S="rating "+ee(f[2][f[5].id])+" svelte-v74z6n")&&u(p,"class",S)},d(f){f&&m(a)}}}function he(i){let a,r=x(i[0]),t=[];for(let s=0;s<r.length;s+=1)t[s]=ae(te(i,r,s));return{c(){a=g("section");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){a=v(s,"SECTION",{class:!0});var n=d(a);for(let e=0;e<t.length;e+=1)t[e].l(n);n.forEach(m),this.h()},h(){u(a,"class","svelte-v74z6n")},m(s,n){$(s,a,n);for(let e=0;e<t.length;e+=1)t[e]&&t[e].m(a,null)},p(s,[n]){if(n&7){r=x(s[0]);let e;for(e=0;e<r.length;e+=1){const c=te(s,r,e);t[e]?t[e].p(c,n):(t[e]=ae(c),t[e].c(),t[e].m(a,null))}for(;e<t.length;e+=1)t[e].d(1);t.length=r.length}},i:G,o:G,d(s){s&&m(a),ie(t,s)}}}function me(i,a,r){let{albums:t=[]}=a,{artists:s={}}=a,{avgRatings:n={}}=a;ne(async()=>{r(0,t=await ce());for(const l of t)s[l.artist]||r(1,s[l.artist]=await e(l.artist),s),l.id in n||r(2,n[l.id]=await c(l.id),n)});async function e(l){try{return await fe(l)}catch(_){return console.error(`Error fetching artist ${l}:`,_),null}}async function c(l){try{const _=await ue(l);return _||0}catch(_){return console.error(`Error fetching average rating for album ${l}:`,_),0}}return i.$$set=l=>{"albums"in l&&r(0,t=l.albums),"artists"in l&&r(1,s=l.artists),"avgRatings"in l&&r(2,n=l.avgRatings)},[t,s,n]}class _e extends re{constructor(a){super(),le(this,a,me,he,se,{albums:0,artists:1,avgRatings:2})}}function ge(i){let a,r,t,s,n;return a=new oe({}),s=new _e({}),{c(){Q(a.$$.fragment),r=z(),t=g("main"),Q(s.$$.fragment),this.h()},l(e){U(a.$$.fragment,e),r=k(e),t=v(e,"MAIN",{class:!0});var c=d(t);U(s.$$.fragment,c),c.forEach(m),this.h()},h(){u(t,"class","svelte-1sgenlr")},m(e,c){W(a,e,c),$(e,r,c),$(e,t,c),W(s,t,null),n=!0},p:G,i(e){n||(X(a.$$.fragment,e),X(s.$$.fragment,e),n=!0)},o(e){Y(a.$$.fragment,e),Y(s.$$.fragment,e),n=!1},d(e){e&&(m(r),m(t)),Z(a,e),Z(s)}}}class Ee extends re{constructor(a){super(),le(this,a,null,ge,se,{})}}export{Ee as component};
