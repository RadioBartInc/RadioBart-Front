import{s as W,n as x,o as ce,d as Q}from"../chunks/scheduler.Cz3TSd7V.js";import{S as X,i as Y,e as d,c as m,A as J,o as i,j as P,g as u,d as E,u as ve,s as H,b as y,h as S,f as j,k as n,l as K,m as D,n as G,p as L,t as V,a as z,r as B}from"../chunks/index.DKOtY3uX.js";import{e as U,N as fe}from"../chunks/Navbar.CYHUjA86.js";import{e as he,d as pe,f as ue,h as de,v as me}from"../chunks/APIAdapter.CWbTadu6.js";import{g as re}from"../chunks/misc.B4lJbiPP.js";function ge(o){let t,r='<div class="review svelte-prf5oo"><img src="https://via.placeholder.com/150" alt="Avatar" class="portada hover-image svelte-prf5oo"/> <div class="contenido svelte-prf5oo"><h3 class="artista svelte-prf5oo"><a href="./">Nombre del artista</a></h3> <h3 class="album svelte-prf5oo"><a href="./">Nombre del album</a></h3> <p class="texto-review">Texto de la review</p></div> <p class="fecha svelte-prf5oo">Fecha de la review</p> <div class="rating-wrapper svelte-prf5oo"><p class="rating good_rating svelte-prf5oo">96</p></div> <div class="usuario svelte-prf5oo"><img src="https://via.placeholder.com/50" alt="Avatar" class="avatar svelte-prf5oo"/> <p><a href="./">Nombre del usuario</a></p></div></div> <div class="review svelte-prf5oo"><img src="https://via.placeholder.com/150" alt="Avatar" class="portada hover-image svelte-prf5oo"/> <div class="contenido svelte-prf5oo"><h3 class="artista svelte-prf5oo"><a href="./">Nombre del artista</a></h3> <h3 class="album svelte-prf5oo"><a href="./">Nombre del album</a></h3> <p class="texto-review">Texto de la review</p></div> <p class="fecha svelte-prf5oo">Fecha de la review</p> <div class="rating-wrapper svelte-prf5oo"><p class="rating good_rating svelte-prf5oo">76</p></div> <div class="usuario svelte-prf5oo"><img src="https://via.placeholder.com/50" alt="Avatar" class="avatar svelte-prf5oo"/> <p><a href="./">Nombre del usuario</a></p></div></div> <div class="review svelte-prf5oo"><img src="https://via.placeholder.com/150" alt="Avatar" class="portada hover-image svelte-prf5oo"/> <div class="contenido svelte-prf5oo"><h3 class="artista svelte-prf5oo"><a href="./">Nombre del artista</a></h3> <h3 class="album svelte-prf5oo"><a href="./">Nombre del album</a></h3> <p class="texto-review">Texto de la review</p></div> <p class="fecha svelte-prf5oo">Fecha de la review</p> <div class="rating-wrapper svelte-prf5oo"><p class="rating bad_rating svelte-prf5oo">32</p></div> <div class="usuario svelte-prf5oo"><img src="https://via.placeholder.com/50" alt="Avatar" class="avatar svelte-prf5oo"/> <p><a href="./">Nombre del usuario</a></p></div></div> <div class="review svelte-prf5oo"><img src="https://via.placeholder.com/150" alt="Avatar" class="portada hover-image svelte-prf5oo"/> <div class="contenido svelte-prf5oo"><h3 class="artista svelte-prf5oo"><a href="./">Nombre del artista</a></h3> <h3 class="album svelte-prf5oo"><a href="./">Nombre del album</a></h3> <p class="texto-review">Texto de la review lorem</p></div> <p class="fecha svelte-prf5oo">Fecha de la review</p> <div class="rating-wrapper svelte-prf5oo"><p class="rating regular_rating svelte-prf5oo">52</p></div> <div class="usuario svelte-prf5oo"><img src="https://via.placeholder.com/50" alt="Avatar" class="avatar svelte-prf5oo"/> <p><a href="./">Nombre del usuario</a></p></div></div>';return{c(){t=d("section"),t.innerHTML=r,this.h()},l(e){t=m(e,"SECTION",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-afqnec"&&(t.innerHTML=r),this.h()},h(){i(t,"class","svelte-prf5oo")},m(e,a){P(e,t,a)},p:x,i:x,o:x,d(e){e&&u(t)}}}class _e extends X{constructor(t){super(),Y(this,t,null,ge,W,{})}}function le(o,t,r){const e=o.slice();return e[5]=t[r],e}function oe(o){var F;let t,r,e,a,l,s,f,v,c=(((F=o[1][o[5].artist])==null?void 0:F.name)||"Nombre del artista")+"",b,N,M,C,w,R=o[5].title+"",A,g,$,T,k=o[2][o[5].id]+"",O,h,I;return{c(){t=d("div"),r=d("a"),e=d("img"),s=H(),f=d("h3"),v=d("a"),b=y(c),M=H(),C=d("h3"),w=d("a"),A=y(R),$=H(),T=d("p"),O=y(k),I=H(),this.h()},l(_){t=m(_,"DIV",{class:!0});var p=E(t);r=m(p,"A",{href:!0});var q=E(r);e=m(q,"IMG",{src:!0,alt:!0,class:!0}),q.forEach(u),s=S(p),f=m(p,"H3",{class:!0});var Z=E(f);v=m(Z,"A",{href:!0});var ee=E(v);b=j(ee,c),ee.forEach(u),Z.forEach(u),M=S(p),C=m(p,"H3",{class:!0});var te=E(C);w=m(te,"A",{href:!0});var ae=E(w);A=j(ae,R),ae.forEach(u),te.forEach(u),$=S(p),T=m(p,"P",{class:!0});var se=E(T);O=j(se,k),se.forEach(u),I=S(p),p.forEach(u),this.h()},h(){Q(e.src,a=o[5].cover)||i(e,"src",a),i(e,"alt","album_cover"),i(e,"class","portada hover-image"),i(r,"href",l=`/album/${o[5].id}`),i(v,"href",N=`/artista/${o[5].artist}`),i(f,"class","artista svelte-10552lv"),i(w,"href",g=`/album/${o[5].id}`),i(C,"class","nombre_album svelte-10552lv"),i(T,"class",h="rating "+re(o[2][o[5].id])+" svelte-10552lv"),i(t,"class","album svelte-10552lv")},m(_,p){P(_,t,p),n(t,r),n(r,e),n(t,s),n(t,f),n(f,v),n(v,b),n(t,M),n(t,C),n(C,w),n(w,A),n(t,$),n(t,T),n(T,O),n(t,I)},p(_,p){var q;p&1&&!Q(e.src,a=_[5].cover)&&i(e,"src",a),p&1&&l!==(l=`/album/${_[5].id}`)&&i(r,"href",l),p&3&&c!==(c=(((q=_[1][_[5].artist])==null?void 0:q.name)||"Nombre del artista")+"")&&K(b,c),p&1&&N!==(N=`/artista/${_[5].artist}`)&&i(v,"href",N),p&1&&R!==(R=_[5].title+"")&&K(A,R),p&1&&g!==(g=`/album/${_[5].id}`)&&i(w,"href",g),p&5&&k!==(k=_[2][_[5].id]+"")&&K(O,k),p&5&&h!==(h="rating "+re(_[2][_[5].id])+" svelte-10552lv")&&i(T,"class",h)},d(_){_&&u(t)}}}function be(o){let t,r=U(o[0]),e=[];for(let a=0;a<r.length;a+=1)e[a]=oe(le(o,r,a));return{c(){t=d("section");for(let a=0;a<e.length;a+=1)e[a].c();this.h()},l(a){t=m(a,"SECTION",{class:!0});var l=E(t);for(let s=0;s<e.length;s+=1)e[s].l(l);l.forEach(u),this.h()},h(){i(t,"class","svelte-10552lv")},m(a,l){P(a,t,l);for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(t,null)},p(a,[l]){if(l&7){r=U(a[0]);let s;for(s=0;s<r.length;s+=1){const f=le(a,r,s);e[s]?e[s].p(f,l):(e[s]=oe(f),e[s].c(),e[s].m(t,null))}for(;s<e.length;s+=1)e[s].d(1);e.length=r.length}},i:x,o:x,d(a){a&&u(t),ve(e,a)}}}function $e(o,t,r){let e=[],a={},l={};ce(async()=>{const v=await he();r(0,e=v.sort((c,b)=>b.fecha.getTime()-c.fecha.getTime()).slice(0,4));for(const c of e)a[c.artist]||r(1,a[c.artist]=await s(c.artist),a),c.id in l||r(2,l[c.id]=await f(c.id),l)});async function s(v){try{return await pe(v)}catch(c){return console.error(`Error fetching artist ${v}:`,c),null}}async function f(v){try{const c=await ue(v);return c??0}catch(c){return console.error(`Error fetching average rating for album ${v}:`,c),0}}return[e,a,l]}class we extends X{constructor(t){super(),Y(this,t,$e,be,W,{})}}function ie(o,t,r){const e=o.slice();return e[2]=t[r],e[4]=r,e}function ne(o){let t,r,e,a,l,s,f,v,c=o[2].name+"",b,N,M,C,w=o[4]+1+"",R,A;return{c(){t=d("div"),r=d("a"),e=d("img"),s=H(),f=d("h3"),v=d("a"),b=y(c),M=H(),C=d("p"),R=y(w),A=H(),this.h()},l(g){t=m(g,"DIV",{class:!0});var $=E(t);r=m($,"A",{href:!0});var T=E(r);e=m(T,"IMG",{src:!0,alt:!0,class:!0}),T.forEach(u),s=S($),f=m($,"H3",{class:!0});var k=E(f);v=m(k,"A",{href:!0});var O=E(v);b=j(O,c),O.forEach(u),k.forEach(u),M=S($),C=m($,"P",{class:!0});var h=E(C);R=j(h,w),h.forEach(u),A=S($),$.forEach(u),this.h()},h(){Q(e.src,a=o[2].foto||"https://via.placeholder.com/150")||i(e,"src",a),i(e,"alt","artista_foto"),i(e,"class","artista_foto hover-image svelte-kxtkp8"),i(r,"href",l=`/artista/${o[2].id}`),i(v,"href",N=`/artista/${o[2].id}`),i(f,"class","artista_nombre svelte-kxtkp8"),i(C,"class","puesto "+(o[4]===0?"primero":o[4]===1?"segundo":o[4]===2?"tercero":"cuarto")+" svelte-kxtkp8"),i(t,"class","artista svelte-kxtkp8")},m(g,$){P(g,t,$),n(t,r),n(r,e),n(t,s),n(t,f),n(f,v),n(v,b),n(t,M),n(t,C),n(C,R),n(t,A)},p(g,$){$&1&&!Q(e.src,a=g[2].foto||"https://via.placeholder.com/150")&&i(e,"src",a),$&1&&l!==(l=`/artista/${g[2].id}`)&&i(r,"href",l),$&1&&c!==(c=g[2].name+"")&&K(b,c),$&1&&N!==(N=`/artista/${g[2].id}`)&&i(v,"href",N)},d(g){g&&u(t)}}}function Ae(o){let t,r=U(o[0]),e=[];for(let a=0;a<r.length;a+=1)e[a]=ne(ie(o,r,a));return{c(){t=d("section");for(let a=0;a<e.length;a+=1)e[a].c();this.h()},l(a){t=m(a,"SECTION",{class:!0});var l=E(t);for(let s=0;s<e.length;s+=1)e[s].l(l);l.forEach(u),this.h()},h(){i(t,"class","svelte-kxtkp8")},m(a,l){P(a,t,l);for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(t,null)},p(a,[l]){if(l&1){r=U(a[0]);let s;for(s=0;s<r.length;s+=1){const f=ie(a,r,s);e[s]?e[s].p(f,l):(e[s]=ne(f),e[s].c(),e[s].m(t,null))}for(;s<e.length;s+=1)e[s].d(1);e.length=r.length}},i:x,o:x,d(a){a&&u(t),ve(e,a)}}}function Ee(o,t,r){let e=[],a={};return ce(async()=>{const l=await de();for(const s of l)a[s.id]=await me(s.id)??0;r(0,e=Object.entries(a).sort(([,s],[,f])=>f-s).slice(0,4).map(([s])=>l.find(f=>f.id===s)).filter(s=>s!==void 0))}),[e]}class Ne extends X{constructor(t){super(),Y(this,t,Ee,Ae,W,{})}}function Ce(o){let t,r,e,a,l,s="Albumes nuevos",f,v,c,b,N,M="Artistas populares",C,w,R,A,g,$="Reviews recientes",T,k,O;return t=new fe({}),v=new we({}),w=new Ne({}),k=new _e({}),{c(){D(t.$$.fragment),r=H(),e=d("main"),a=d("section"),l=d("h2"),l.textContent=s,f=H(),D(v.$$.fragment),c=H(),b=d("section"),N=d("h2"),N.textContent=M,C=H(),D(w.$$.fragment),R=H(),A=d("section"),g=d("h2"),g.textContent=$,T=H(),D(k.$$.fragment),this.h()},l(h){G(t.$$.fragment,h),r=S(h),e=m(h,"MAIN",{});var I=E(e);a=m(I,"SECTION",{class:!0,id:!0});var F=E(a);l=m(F,"H2",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-1u93rcc"&&(l.textContent=s),f=S(F),G(v.$$.fragment,F),F.forEach(u),c=S(I),b=m(I,"SECTION",{class:!0,id:!0});var _=E(b);N=m(_,"H2",{class:!0,"data-svelte-h":!0}),J(N)!=="svelte-5v3bez"&&(N.textContent=M),C=S(_),G(w.$$.fragment,_),_.forEach(u),R=S(I),A=m(I,"SECTION",{class:!0,id:!0});var p=E(A);g=m(p,"H2",{class:!0,"data-svelte-h":!0}),J(g)!=="svelte-ocb0vo"&&(g.textContent=$),T=S(p),G(k.$$.fragment,p),p.forEach(u),I.forEach(u),this.h()},h(){i(l,"class","section-title svelte-ltg7ov"),i(a,"class","section-body svelte-ltg7ov"),i(a,"id","albums-recientes"),i(N,"class","section-title svelte-ltg7ov"),i(b,"class","section-body svelte-ltg7ov"),i(b,"id","albums-populares"),i(g,"class","section-title svelte-ltg7ov"),i(A,"class","section-body svelte-ltg7ov"),i(A,"id","reviews-recientes")},m(h,I){L(t,h,I),P(h,r,I),P(h,e,I),n(e,a),n(a,l),n(a,f),L(v,a,null),n(e,c),n(e,b),n(b,N),n(b,C),L(w,b,null),n(e,R),n(e,A),n(A,g),n(A,T),L(k,A,null),O=!0},p:x,i(h){O||(V(t.$$.fragment,h),V(v.$$.fragment,h),V(w.$$.fragment,h),V(k.$$.fragment,h),O=!0)},o(h){z(t.$$.fragment,h),z(v.$$.fragment,h),z(w.$$.fragment,h),z(k.$$.fragment,h),O=!1},d(h){h&&(u(r),u(e)),B(t,h),B(v),B(w),B(k)}}}class Se extends X{constructor(t){super(),Y(this,t,null,Ce,W,{})}}export{Se as component};
